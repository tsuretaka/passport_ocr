# パスポートOCRシステム 操作マニュアル

このシステムは、パスポート画像を読み取り、氏名や旅券番号などの情報を自動抽出して管理・Excel出力するためのアプリケーションです。

## 0. 設計の思想

1.このシステムは、通常業務の中で行われる【海外旅行名簿作成】というプロセスを可能な限り簡素化する事、お客様から得たパスポート画像から読み込んだ情報で、残存期限の必要日数チェックをファーストスクリーニングする事で業務効率化を上げ、人間が最終的なチェックに当てられる時間を確保する事を目的として作成されています。したがって、このシステムを使えばチェックも含め全てがオートメーションされるという事ではなく、あくまで【人間が行う事を明確にし、その時間の確保に助力するシステム】であるという事を認識ください。
2.このシステムのセキュリティポリシーとして【パスポート情報という個人情報はシステム内に保存しない】という思想設計になっています。データーベースに保存する思想設計にする場合、そのシステムのセキュリティコストが段違いとなりますのでご了承ください。

## 1. ログイン

1. アプリケーションにアクセスするとログイン画面が表示されます。
2. 管理者から配布された「ユーザー名」と「パスワード」を入力し、ログインボタンを押してください。

## 2. パスポート読取（OCR実行）

画面上部のタブから**「📂 パスポート読取」**を選択します。

### 手順
1. **画像のアップロード**: 
   - 「画像をアップロード」エリアにパスポートの画像（JPG, PNG, PDFなど）をドラッグ＆ドロップするか、クリックしてファイルを選択します。
   - 複数枚の同時アップロードも可能です。
2. **読取結果の確認**:
   - 画像がアップロードされると自動的にAIによる文字認識（OCR）が始まります。
   - 認識結果が画面に表示されます。
   - **自動補正機能**: 全角文字は自動的に半角に変換され、不要なスペースも削除されます。
3. **データの登録**:
   - 内容を確認し、問題なければ**「データ管理へ追加」**ボタンを押してください。
   - データが一時保存領域（データ管理タブ）に転送されます。

## 3. データ管理・編集

読み取ったデータの一覧確認、修正、並び替え、ダウンロードは**「📊 データ管理」**タブで行います。

### 画面の見方
- 登録されたデータが表形式（グリッド）で表示されます。
- 列見出し: 「登録日時」「旅券番号」「氏名(姓)」「氏名(名)」などが表示されます。

### 操作方法

#### ✅ 行の並び替え（ドラッグ＆ドロップ）
データの順番を自由に入れ替えることができます。それにより、部屋割り順などに並べ替えた上でエクセルに出力し以降の作業を効率的なものにします。
1. **行の移動**: 行の左端等を掴んで、目的の位置までドラッグ＆ドロップします。
2. **同期**: 指を離すと画面が一瞬読み込まれ、新しい順番が自動的にシステムに認識されます。
   - ※もし反応がない場合は、表の上にある**「🔄 並び順を強制更新」**ボタンを押すか、表内の任意の場所をクリックしてください。
3. **確認**: 必要に応じて、表の下にある「👀 現在の並び順を全件確認する」を開き、正しい順番になっているか確認できます。

#### ✅ データの修正
- 修正したいセル（文字）を**ダブルクリック**すると入力モードになり、内容を直接書き換えることができます。
- 修正後、Enterキーを押すと確定されます。

#### ✅ 行の削除
- 削除したい行のチェックボックス（左端）にチェックを入れます。
- 表の下にある**「🗑️ 選択行を削除」**ボタンを押すと削除されます。

#### ✅ 変更の確定（保存）
- 並び替えや修正を行った後は、必ず**「💾 並び替え・編集を保存」**ボタンを押してください。
- これにより、現在の見た目通りの状態でデータが確定されます。
- **注意**: このボタンを押さないと、Excelダウンロード時に変更が反映されない場合があります。

#### ✅ Excelダウンロード
- **「📥 Excelファイルとしてダウンロード」**ボタンを押すと、現在表示されているデータをExcel形式（.xlsx）でダウンロードできます。

## ⚠️ 注意事項
- このシステム上のデータはブラウザの一時メモリに保存されています。
- **ブラウザを再読み込み（F5キーなど）したり、タブを閉じるとデータは消えてしまいます**。
- 作業完了後は必ずExcelファイルをダウンロードしてデータを手元に保存してください。
